<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>RJP Employee ID Card Generator</title>
<script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/qrcodejs/1.0.0/qrcode.min.js"></script>
<style>
    body { font-family: Arial, sans-serif; background: #f4f6f8; margin: 0; padding: 20px; }
    h1 { margin: 0; font-size: 20px; }
    .company-info { font-size: 14px; color: #555; }
    .container { max-width: 1100px; margin: auto; }
    form { display: grid; grid-template-columns: 1fr 300px; gap: 20px; margin-top: 20px; }
    .panel { background: white; padding: 15px; border-radius: 8px; box-shadow: 0 0 10px rgba(0,0,0,0.05); }
    label { font-weight: bold; font-size: 13px; margin-top: 8px; display: block; }
    input, textarea { width: 100%; padding: 8px; border: 1px solid #ccc; border-radius: 4px; font-size: 14px; margin-top: 3px; }
    input[type=file] { padding: 5px; }
    .buttons { display: flex; flex-wrap: wrap; gap: 8px; margin-top: 10px; }
    button { padding: 8px 12px; border: none; border-radius: 4px; font-weight: bold; cursor: pointer; }
    .primary { background: #007bff; color: white; }
    .secondary { background: #6c757d; color: white; }
    .danger { background: #dc3545; color: white; }
    .photo-preview { width: 100%; height: 200px; border: 1px dashed #aaa; display: flex; align-items: center; justify-content: center; overflow: hidden; background: #fafafa; border-radius: 6px; }
    .photo-preview img { max-width: 100%; max-height: 100%; }
    .id-preview { display: flex; gap: 15px; margin-top: 15px; flex-wrap: wrap; }
    .id-card { width: 320px; border: 1px solid #ccc; border-radius: 8px; background: white; padding: 10px; text-align: center; }
    .id-card img { width: 80px; height: 100px; object-fit: cover; border-radius: 4px; }
</style>
</head>
<body>

<div class="container">
    <h1>RJP Contract Private Solutions Finance Limited</h1>
    <div class="company-info">Email: rjpmilsprivatelimited@gmail.com | Phone: 7896220943 /9344958807/6001571316</div>
    <div class="company-info">Address: Golaghat - Assam 789611, Badulipar </div>

    <form id="empForm">
        <div class="panel">
            <label>Employee Name</label>
            <input type="text" id="empName" required>
            <label>DOB</label>
            <input type="date" id="dob">
            <label>Father Name</label>
            <input type="text" id="fatherName">
            <label>Mother Name</label>
            <input type="text" id="motherName">
            <label>Email</label>
            <input type="email" id="email">
            <label>Contact Number</label>
            <input type="text" id="contact">
            <label>Aadhaar Number</label>
            <input type="text" id="aadhaar">
            <label>Voter ID</label>
            <input type="text" id="voterId">
            <label>PAN Number</label>
            <input type="text" id="pan">
            <label>Account Number</label>
            <input type="text" id="account">
            <label>Designation</label>
            <input type="text" id="designation">
            <label>Last Passed Out</label>
            <input type="text" id="lastPassed">
            <label>DOJ</label>
            <input type="date" id="doj">
            <label>Blood Group</label>
            <input type="text" id="blood">
            <label>Employee Address</label>
            <textarea id="address"></textarea>

            <div class="buttons">
                <button type="button" class="primary" onclick="saveToLocal()">Save to Local</button>
                <button type="button" class="primary" onclick="generateIDCard()">Generate & Print</button>
                <button type="button" class="primary" onclick="downloadExcel()">Download Excel</button>
                <button type="button" class="secondary" onclick="showEmployees()">Employee Details</button>
                <button type="button" class="secondary" onclick="resetForm()">Reset Form</button>
                <button type="button" class="danger" onclick="clearLocal()">Clear Local Data</button>
            </div>
        </div>

        <div class="panel">
            <label>Upload Photo</label>
            <input type="file" accept="image/*" onchange="previewPhoto(event)">
            <div class="photo-preview" id="photoPreview">No Photo</div>
        </div>
    </form>

    <div class="id-preview">
        <div class="id-card" id="idCard">
            <h3>RJP Contract Pvt. Solutions Finance Ltd.</h3>
            <p>Email:rjpmilsprivatelimited@gmail.com</p>
            <p>Address: Golaghat - Assam 789611, Badulipar</p>
            <p id="empId">Employee ID: -</p>
            <img id="cardPhoto" src="">
            <p id="cardName">Name: -</p>
            <p id="cardDesignation">Designation: -</p>
            <p id="cardContact">Contact: -</p>
            <p id="cardAddress">Address: -</p>
            <div id="qrcode"></div>
        </div>
    </div>
</div>

<script>
let employees = JSON.parse(localStorage.getItem('employees') || '[]');

function previewPhoto(e) {
    const file = e.target.files[0];
    if (file) {
        const img = document.createElement('img');
        img.src = URL.createObjectURL(file);
        document.getElementById('photoPreview').innerHTML = '';
        document.getElementById('photoPreview').appendChild(img);
        document.getElementById('cardPhoto').src = img.src;
    }
}

function generateEmployeeID() {
    return 'RJP-EMP-' + String(employees.length + 1).padStart(4, '0');
}

function readForm() {
    return {
        empId: generateEmployeeID(),
        name: document.getElementById('empName').value,
        dob: document.getElementById('dob').value,
        father: document.getElementById('fatherName').value,
        mother: document.getElementById('motherName').value,
        email: document.getElementById('email').value,
        contact: document.getElementById('contact').value,
        aadhaar: document.getElementById('aadhaar').value,
        voterId: document.getElementById('voterId').value,
        pan: document.getElementById('pan').value,
        account: document.getElementById('account').value,
        designation: document.getElementById('designation').value,
        lastPassed: document.getElementById('lastPassed').value,
        doj: document.getElementById('doj').value,
        blood: document.getElementById('blood').value,
        address: document.getElementById('address').value,
        photo: document.getElementById('cardPhoto').src
    };
}

function saveToLocal() {
    const emp = readForm();
    employees.push(emp);
    localStorage.setItem('employees', JSON.stringify(employees));
    alert('Employee saved locally.');
}

function downloadExcel() {
    if (employees.length === 0) { alert('No data'); return; }
    const ws = XLSX.utils.json_to_sheet(employees);
    const wb = XLSX.utils.book_new();
    XLSX.utils.book_append_sheet(wb, ws, "Employees");
    XLSX.writeFile(wb, "employees.xlsx");
}

function generateIDCard() {
    const emp = readForm();
    document.getElementById('empId').innerText = "Employee ID: " + emp.empId;
    document.getElementById('cardName').innerText = "Name: " + emp.name;
    document.getElementById('cardDesignation').innerText = "Designation: " + emp.designation;
    document.getElementById('cardContact').innerText = "Contact: " + emp.contact;
    document.getElementById('cardAddress').innerText = "Address: " + emp.address;

    // Generate QR Code
    document.getElementById('qrcode').innerHTML = '';
    new QRCode(document.getElementById('qrcode'), {
        text: JSON.stringify(emp),
        width: 80,
        height: 80
    });

    // Save PDF
    html2canvas(document.getElementById("idCard")).then(canvas => {
        const imgData = canvas.toDataURL("image/png");
        const { jsPDF } = window.jspdf;
        const pdf = new jsPDF();
        pdf.addImage(imgData, 'PNG', 15, 15, 80, 90);
        pdf.save(emp.name + "_IDCard.pdf");
    });
}

function resetForm() {
    document.getElementById('empForm').reset();
    document.getElementById('photoPreview').innerHTML = 'No Photo';
    document.getElementById('cardPhoto').src = '';
}

function clearLocal() {
    if (confirm('Clear all saved employees?')) {
        employees = [];
        localStorage.removeItem('employees');
    }
}

function showEmployees() {
    alert(JSON.stringify(employees, null, 2));
}
</script>

</body>
</html>
